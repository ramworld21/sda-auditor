<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8">
    <title>Ù…Ø¯Ù‚Ù‚ Ù…ÙˆØ§Ù‚Ø¹ RAM World</title>
    <style>
@media (max-width:720px) {
  #submit-section > div {
    width:100% !important;
    max-width:95% !important;
    margin:0 auto 20px auto !important;
    display:flex !important;
    flex-direction:column !important;
    align-items:center !important;
    padding:16px !important;
  }
  #submit-section label {
    flex-direction:column !important;
    align-items:flex-start !important;
    gap:12px !important;
  }
  #submit-section input[type="checkbox"] {
    margin-right:0 !important;
    margin-top:0 !important;
  }
}
/* === Responsive submit box and features for mobile === */
.submit-box {
  background:white;
  border:1px solid #e5e7eb;
  border-radius:16px;
  padding:20px;
  max-width:720px;
  width:100%;
  margin:0 auto 24px auto;
  display:flex;
  flex-direction:column;
  align-items:center;
  box-shadow:0 4px 18px rgba(0,0,0,0.06);
  box-sizing:border-box;
  transition:all 0.25s;
}
@media (max-width:430px) {
  .submit-box {
    padding:12px !important;
    width:95% !important;
    max-width:95% !important;
    margin:12px auto !important;
    flex-direction:column !important;
    align-items:center !important;
  }
  .features-grid {
    grid-template-columns:1fr !important;
    gap:12px !important;
    width:100% !important;
    margin:0 auto !important;
    padding:0 !important;
  }
  .feature-card {
    padding:14px !important;
    border-radius:10px !important;
    text-align:center !important;
    box-shadow:0 1px 4px rgba(0,0,0,0.08) !important;
  }
}
</style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;600;700&display=swap"
      rel="stylesheet">
    <style>
    :root {
      --background: 0 0% 100%;
      --foreground: 200 20% 15%;

      --card: 0 0% 100%;
      --card-foreground: 200 20% 15%;

      --popover: 0 0% 100%;
      --popover-foreground: 200 20% 15%;

      /* Saudi government blue */
      --primary: 200 80% 35%;
      --primary-foreground: 0 0% 100%;
      /* Primary/Secondary hex colors (used for UI elements) */
      --primary-color: #062c6e;
      --primary-rgba-08: rgba(6,44,110,0.08);
      --primary-rgba-12: rgba(6,44,110,0.12);
      --secondary-color: #2db9db;
      --secondary-rgba-12: rgba(45,185,219,0.12);
      
      /* Saudi green accent */
      --secondary: 145 65% 40%;
      --secondary-foreground: 0 0% 100%;

      --muted: 200 20% 96%;
      --muted-foreground: 200 15% 45%;

      --accent: 145 65% 40%;
      --accent-foreground: 0 0% 100%;
      /* Accent tied to secondary hex for UI elements */
      --accent-color: var(--secondary-color);

      --destructive: 0 70% 50%;
      --destructive-foreground: 0 0% 100%;

      --border: 200 20% 88%;
      --input: 200 20% 88%;
      --ring: 200 80% 35%;

      --success: 145 65% 40%;
      --success-foreground: 0 0% 100%;
      
      --warning: 40 95% 50%;
      --warning-foreground: 200 20% 15%;

      --radius: 0.5rem;

      /* Gradients */
      --gradient-primary: linear-gradient(135deg, #062c6e, hsl(200 70% 45%));
      --gradient-hero: linear-gradient(135deg, #062c6e 0%, hsl(145 65% 40%) 100%);
      
      /* Shadows */
      --shadow-sm: 0 2px 8px hsl(200 20% 15% / 0.08);
      --shadow-md: 0 4px 16px hsl(200 20% 15% / 0.12);
      --shadow-lg: 0 8px 32px hsl(200 20% 15% / 0.16);
    }
    html,body{height:100%;}
  body{font-family:'IBM Plex Sans Arabic', Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; margin:0; background: #f8f9fa; color: hsl(var(--foreground));}
    .container{max-width:680px;margin:0 auto;padding:24px}
    .card{background: white; color: hsl(var(--card-foreground)); width:100%; max-width:680px; margin:24px auto; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.1); padding:40px 36px; display:block;border:1px solid #e5e7eb}
    .site-header{background:white !important;border-bottom:1px solid #e5e7eb !important}
    .header-logo{display:flex;align-items:center;gap:12px}
    .header-logo img{width:36px;height:36px}
    .hero{text-align:center;padding:0 0 24px 0}
    .hero h1{font-size:28px;line-height:1.3;margin:14px 0;color:#1a1a1a;font-weight:700}
    .hero p.lead{max-width:100%;margin:8px auto 0;color:#6b7280;font-size:14px;line-height:1.6}
    .form-container{background:#f8f9fa;padding:24px;margin:0;border-radius:10px;border:1px solid #e5e7eb}
    .form-section{background:white;border:1px solid #d1d5db;border-radius:10px;padding:20px;margin-bottom:14px;box-shadow:0 1px 3px rgba(0,0,0,0.08)}
    .form-section:last-child{margin-bottom:0}
    /* Desktop: 3 cards in a row */
    .features-box {
      display: flex;
      justify-content: center;
      width: 100%;
      margin: 24px 0;
      padding: 0 12px;
      box-sizing: border-box;
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      max-width: 1024px;
      width: 100%;
      margin: 0 auto;
      box-sizing: border-box;
    }

    .feature-card {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      transition: all 0.25s;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
    }
    .feature-card .icon{width:56px;height:56px;border-radius:12px;background:var(--secondary-rgba-12);color:hsl(var(--secondary-foreground));display:inline-flex;align-items:center;justify-content:center;margin:0 auto 12px}
    .feature-card .icon svg{width:28px;height:28px;stroke:currentColor;fill:none;stroke-width:1.6}
    .logo{display:flex; align-items:center; gap:14px}
  .logo .mark{width:64px;height:64px;border-radius:12px;background:linear-gradient(180deg,var(--primary-color),#062c6e);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:18px}
    h1{font-size:24px;margin:0;color:#1a1a1a}
    h3{font-size:16px;font-weight:600;color:#1a1a1a;margin:0 0 12px 0}
    p.lead{color:#6b7280;margin-top:6px;margin-bottom:18px}
    form{display:flex;flex-direction:column;gap:16px}
    /* modern search box */
    .search {
      display:flex;align-items:center;gap:10px;background:hsl(var(--input));padding:10px;border-radius:12px;border:1px solid hsl(var(--border));transition:box-shadow .18s ease,border-color .18s ease;min-width:350px;width:100%;
    }
  /* When the search gains focus make it flexible (auto) up to a max width */
  .search:focus-within{border-color:rgba(6,44,110,0.14);box-shadow:0 8px 24px rgba(2,6,23,0.06);width:auto;max-width:640px}
    .search svg{width:20px;height:20px;flex:0 0 20px;fill:var(--muted);opacity:0.95}
    #website-url{border:none;background:transparent;padding:10px 8px;font-size:15px;outline:none;direction:ltr;min-width:160px;width:auto}
    .search .hint{font-size:12px;color:var(--muted);margin-top:4px}
    .controls{display:flex;gap:8px;align-items:center}
    .controls-block{width:220px;display:flex;flex-direction:column;gap:8px}
    button.primary{background:var(--primary-color);color:#fff;padding:14px 24px;border-radius:10px;border:none;font-weight:600;cursor:pointer;font-size:16px;width:100%;transition:all 0.2s}
    button.primary:hover{background:#051f4d}
    button.ghost{background:transparent;border:1px solid #e5e7eb;padding:10px 12px;border-radius:8px;color:#6b7280;cursor:pointer}
    .status{margin-top:12px;color:var(--primary-color);min-height:28px;display:flex;align-items:center;gap:10px}
    .loader{width:18px;height:18px;border:3px solid #e6eefc;border-top-color:var(--primary-color);border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
  .result-link{display:inline-block;margin-top:8px;padding:8px 10px;background:var(--accent-color);color:#fff;border-radius:8px;text-decoration:none}

  #scan-panel-top { text-align: center; margin:16px 0; display:block; max-width:100%; }
  #scan-panel-top .scan-actions { display:flex; justify-content:center; gap:8px; margin-top:10px }

  /* Style the report button to use the accent color when visible */
  button.ghost#open-report{background:var(--accent-color);color:hsl(var(--accent-foreground));border:none;padding:10px 12px}
  button.ghost#open-report:hover{filter:brightness(.96)}
    .right-panel{background:white;border-radius:12px;padding:20px;border:1px solid #e5e7eb;max-width:100%;width:100%;box-shadow:0 1px 2px rgba(0,0,0,0.05)}
    .card > div:first-child{padding-right:12px}
    .card > div:first-child .lead{max-width:680px;color:hsl(var(--muted-foreground))}
    button.ghost#open-report{padding:10px 14px;min-width:110px}
    button.primary{min-width:140px}
    .hidden{display:none !important;visibility:hidden;opacity:0}
    .step{display:flex;align-items:center;gap:12px;padding:8px 0}
    .step svg{width:48px;height:48px;flex:0 0 48px}
    .step .dot{width:10px;height:10px;border-radius:50%;background:#e6eefc}
    .step.active .dot{background:var(--primary-color)}
    .muted{color:hsl(var(--muted-foreground))}
    footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}
    /* Tablet: 2 cards */
    @media (max-width:767px) {
      .features-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 14px;
        max-width: 680px;
        margin: 0 auto;
        padding: 0 12px;
      }
    }

    /* Mobile: 1 card per row */
    @media (max-width:520px) {
      .features-grid {
        grid-template-columns: 1fr;
        gap: 12px;
        max-width: 95%;
        margin: 0 auto;
        padding: 0 8px;
      }
    }
    @media (max-width:768px) {
      .container{max-width:540px;padding:20px}
      .card{max-width:540px;padding:32px 28px}
      .hero h1{font-size:24px}
    }
    @media (max-width:520px) {
      .container{padding:16px;max-width:100%}
      .card{padding:24px 20px;margin:16px auto;max-width:100%}
      .hero h1{font-size:20px}
      .hero p.lead{font-size:12px}
      .form-section{padding:16px}
      .form-container{padding:18px}
    }

    /* Responsive rules for the compact scan panel */
    /* Keep the panel centered and scale it on smaller screens */
    @media (min-width:721px) and (max-width:1200px) {
      #scan-panel-top { max-width:640px; }
    }

    @media (max-width:720px) {
      /* Use almost full width on small viewports and ensure padding fits */
      #scan-panel-top { max-width:92%; margin:12px auto; padding:12px; box-sizing:border-box; }
      /* Keep actions centered and allow wrapping for multiple buttons */
      #scan-panel-top .scan-actions { justify-content:center; flex-wrap:wrap; gap:6px }
      /* Make the report button easier to tap on small screens */
      #scan-panel-top .scan-actions button, #scan-panel-top button#open-report { width:100%; max-width:360px; margin:6px auto 0; display:block }
    }

    /* Mobile specific strict containment for 430px width */
    @media (max-width:450px) {
      html, body {
        font-size:14px;
        max-width:430px;
        width:100%;
        overflow-x:hidden;
        overflow-y:auto;
        margin:0;
        padding:0;
        box-sizing:border-box;
      }

      body {
        min-height:100vh;
      }

      .container, .card {
        max-width:100%;
        padding:12px;
        margin:0 auto;
        /* Limit height to viewport, allow scrolling if needed */
        max-height:100vh;
        overflow-y:auto;
        box-sizing:border-box;
      }

      .card {
        box-sizing:border-box;
        width:100%;
        margin:0 auto;
        padding:12px;
        border-radius:12px;
      }

      .hero {
        padding:12px 0;
      }

      .hero h1 {
        font-size:18px;
        line-height:1.2;
      }

      .hero p.lead {
        font-size:12px;
        margin:6px 0 12px 0;
      }

      .form-container {
        padding:12px;
      }

      .form-section {
        padding:10px;
        margin-bottom:10px;
      }

      #submit-section > .submit-box {
        padding:10px;
        width:100% !important;
        max-width:100% !important;
        margin:8px auto !important;
      }

      button.primary {
        font-size:14px;
        padding:10px 16px;
        width:100%;
      }

      .features-box {
        padding:0 6px;
      }

      .features-grid {
        grid-template-columns:1fr !important;
        gap:10px !important;
        width:100% !important;
        margin:0 auto !important;
        padding:0 !important;
      }

      .feature-card {
        padding:12px !important;
        border-radius:10px;
        box-shadow:0 1px 3px rgba(0,0,0,0.06);
        text-align:center;
      }

      .feature-card .icon {
        width:40px;
        height:40px;
      }

      .feature-card .icon svg {
        width:20px;
        height:20px;
      }

      .search {
        min-width:auto;
        width:100%;
        padding:8px;
      }

      .search input {
        font-size:14px;
        padding:8px;
      }

      #scan-panel-top, #scan-panel {
        padding:8px;
        margin:8px 0;
      }

      .step svg {
        width:32px;
        height:32px;
      }

      .step .dot {
        width:8px;
        height:8px;
      }

      footer {
        font-size:11px;
        margin:8px 0;
      }
    }
  </style>
  </head>
  <body>
    <!-- Header with logo and Ramworld link -->
    <header class="site-header"
      style="position:sticky;top:0;z-index:50;background:white;border-bottom:1px solid #e5e7eb;box-shadow:0 1px 2px rgba(0,0,0,0.05)">
      <div style="max-width:680px;margin:0 auto;padding:14px 24px;">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:12px">
          <!-- Left: Logo with title -->
          <div style="display:flex;align-items:center;gap:12px;flex:1;min-width:0">
            <img src="RAM D.png" alt="Logo"
              style="width:36px;height:36px;border-radius:6px;background:#062c6e;padding:4px;object-fit:contain;flex-shrink:0">
            <div style="min-width:0">
              <div style="font-weight:700;color:#1a1a1a;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">Ù…Ø¯Ù‚Ù‚ ÙƒÙˆØ¯ Ø§Ù„Ù…Ù†ØµØ§Øª Ø§Ù„Ù…ÙˆØ­Ø¯</div>
              <div style="font-size:10px;color:#6b7280">DGA Unified Design Code Validator</div>
            </div>
          </div>
          
          <!-- Right: Ramworld Tech Solutions -->
          <div style="flex-shrink:0">
            <a href="https://ramworld.net" target="_blank" rel="noopener noreferrer" 
               style="display:flex;align-items:center;gap:6px;text-decoration:none;padding:6px 10px;border-radius:6px;background:#f8f9fa;border:1px solid #e5e7eb;transition:all 0.2s"
               onmouseover="this.style.background='#e5e7eb'"
               onmouseout="this.style.background='#f8f9fa'">
              <img
                src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ0C8AdcJDIDRyV-2Yz3wyd2YNzhxAWd4LH8w&s"
                alt="Ramworld"
                style="width:24px;height:24px;border-radius:4px;object-fit:contain">
              <div style="text-align:right">
                <div style="font-size:10px;font-weight:600;color:#1a1a1a;line-height:1.2">Ramworld</div>
                <div style="font-size:8px;color:#6b7280;line-height:1.2">Tech Solutions</div>
              </div>
            </a>
          </div>
        </div>
      </div>
    </header>

    <div class="card" role="main">
      <div>
        <div class="hero" style="text-align:center;margin-bottom:20px">
          <div
            style="display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:20px;background:#f3f4f6;color:#6b7280;margin:0 auto 12px;">
            <span style="font-size:12px;font-weight:500">Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù…Ù† Ø¹Ø§Ù„Ù… Ø±Ø§Ù… Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„ØªÙ‚Ù†ÙŠØ©</span>
          </div>
          <h1>ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙˆØ§ÙÙ‚ Ù…ÙˆÙ‚Ø¹Ùƒ Ù…Ø¹<br><span style="color:var(--primary-color)">Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„Ø­ÙƒÙˆÙ…Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</span></h1>
          <p class="lead">Ø£Ø¯Ø§Ø© Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…ØªÙ‚Ø¯Ù…Ø© ØªÙØ­Øµ 56 Ù…Ø¹ÙŠØ§Ø±Ø§Ù‹ Ù…Ù† Ù…Ø¹Ø§ÙŠÙŠØ± Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ÙˆØ­Ø¯ ÙˆØªÙ‚Ø¯Ù… ØªÙˆØµÙŠØ§Øª Ù…Ø­Ø¯Ø¯Ø© Ù„Ù„ØªØ­Ø³ÙŠÙ†</p>
        </div>

        <div class="form-container" style="margin-bottom:20px">
              <form id="scan-form" aria-label="scan form">

                <!-- Email Input Section -->
                <div class="form-section">
                  <label for="user-email"
                    style="display:flex;align-items:center;gap:8px;margin-bottom:12px;font-weight:500;font-size:14px;color:#374151">
                    <svg viewBox="0 0 24 24"
                      style="width:18px;height:18px"
                      fill="none" stroke="currentColor" stroke-width="2"><path
                        d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                    Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
                  </label>
                  <input
                    type="email"
                    id="user-email"
                    name="user-email"
                    placeholder="example@domain.com"
                    required
                    autocomplete="email"
                    aria-label="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"
                    style="width:100%;padding:12px 16px;font-size:15px;border:1px solid #d1d5db;border-radius:8px;background:#f9fafb;color:#1a1a1a;font-family:'IBM Plex Sans Arabic',Arial,sans-serif;transition:all 0.2s;outline:none;box-sizing:border-box"
                    onfocus="this.style.borderColor='var(--primary-color)';this.style.background='white'"
                    onblur="this.style.borderColor='#d1d5db';this.style.background='#f9fafb'">
                  <div
                    style="font-size:11px;margin-top:8px;display:flex;align-items:center;gap:4px;color:#9ca3af">
                    <svg viewBox="0 0 24 24" style="width:12px;height:12px"
                      fill="currentColor"><path
                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" /></svg>
                    Ø³Ù†Ø³ØªØ®Ø¯Ù… Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ø­ÙØ¸ Ø³Ø¬Ù„ Ø§Ù„ÙØ­Øµ ÙÙ‚Ø·
                  </div>
                </div>

                <!-- Website URL Section (Hidden by default) -->
                <div class="form-section" style="display:none" id="url-section">
                  <label for="website-url"
                    style="display:flex;align-items:center;gap:8px;margin-bottom:12px;font-weight:500;font-size:14px;color:#374151">
                    <svg viewBox="0 0 24 24"
                      style="width:18px;height:18px"
                      fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
                    Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø±Ø§Ø¯ ÙØ­ØµÙ‡
                  </label>
                  <input type="text" id="website-url"
                    name="website-url"
                    placeholder="Ù…Ø«Ø§Ù„: dga.gov.sa Ø£Ùˆ https://example.gov.sa"
                    inputmode="url" required autocomplete="off"
                    aria-label="Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹"
                    style="width:100%;padding:12px 16px;font-size:15px;border:1px solid #d1d5db;border-radius:8px;background:#f9fafb;color:#1a1a1a;font-family:'IBM Plex Sans Arabic',Arial,sans-serif;transition:all 0.2s;outline:none;direction:ltr;text-align:left;box-sizing:border-box"
                    onfocus="this.style.borderColor='var(--primary-color)';this.style.background='white'"
                    onblur="this.style.borderColor='#d1d5db';this.style.background='#f9fafb'">
                  <div
                    style="font-size:11px;margin-top:8px;display:flex;align-items:center;gap:4px;color:#9ca3af">
                    <svg viewBox="0 0 24 24" style="width:12px;height:12px"
                      fill="currentColor"><path
                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" /></svg>
                    ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù†Ø·Ø§Ù‚ ÙÙ‚Ø· ÙˆØ³ÙŠÙØ¶Ø§Ù Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                  </div>
                </div>

                <!-- Submit Section -->
                <div id="submit-section" style="display:none">
                  <div class="submit-box">
                    <label style="display:flex;align-items:flex-start;gap:14px;cursor:pointer;user-select:none">
                      <input type="checkbox" id="fast-mode" name="fast-mode" />
                      <div style="flex:1">
                        <div style="font-weight:700;color:#0f172a;font-size:15px;margin-bottom:10px;display:flex;align-items:center;gap:8px">
                          Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø³Ø±ÙŠØ¹ (Fast Mode)
                          <span style="background:#fef3c7;color:#92400e;padding:2px 8px;border-radius:6px;font-size:11px;font-weight:600">Ø§Ø®ØªÙŠØ§Ø±ÙŠ</span>
                        </div>
                        <div style="background:white;padding:14px;border-radius:10px;margin-bottom:10px;border-right:4px solid var(--primary-color);box-shadow:0 1px 4px rgba(0,0,0,0.05)">
                          <div style="font-size:13px;color:#475569;line-height:1.7;margin-bottom:8px">
                            <div style="display:flex;align-items:center;gap:8px;margin-bottom:6px">
                              <span style="font-size:18px">âš¡</span>
                              <span style="font-weight:700;color:var(--primary-color)">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø³Ø±ÙŠØ¹:</span>
                              <span style="background:#dbeafe;color:#1e40af;padding:2px 8px;border-radius:6px;font-size:12px;font-weight:600">~2-3 Ø¯Ù‚Ø§Ø¦Ù‚</span>
                            </div>
                            <div style="margin-right:26px;color:#64748b;font-size:12px">Ù„Ø§ ÙŠØ´Ù…Ù„ Ù„Ù‚Ø·Ø§Øª Ø´Ø§Ø´Ø© Ù…ØªØ¹Ø¯Ø¯Ø© ÙˆÙ…ØªØ¬Ø§ÙˆØ¨Ø©</div>
                          </div>
                        </div>
                        <div style="background:white;padding:14px;border-radius:10px;border-right:4px solid #16a75a;box-shadow:0 1px 4px rgba(0,0,0,0.05)">
                          <div style="font-size:13px;color:#475569;line-height:1.7">
                            <div style="display:flex;align-items:center;gap:8px;margin-bottom:6px">
                              <span style="font-size:18px">ğŸ”</span>
                              <span style="font-weight:700;color:#16a75a">Ø§Ù„ÙØ­Øµ Ø§Ù„ÙƒØ§Ù…Ù„:</span>
                              <span style="background:#dcfce7;color:#166534;padding:2px 8px;border-radius:6px;font-size:12px;font-weight:600">~5-8 Ø¯Ù‚Ø§Ø¦Ù‚</span>
                            </div>
                            <div style="margin-right:26px;color:#64748b;font-size:12px">ÙŠØ´Ù…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙˆÙ„Ù‚Ø·Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø© ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù† ØºÙŠØ± Ø§Ù„Ù…ØªÙˆØ§ÙÙ‚Ø©</div>
                          </div>
                        </div>
                      </div>
                    </label>
                    <button class="primary" type="submit" id="scan-button">
                      <svg viewBox="0 0 24 24" style="width:22px;height:22px;display:inline-block;margin-top: 20px !important;vertical-align:middle;margin-left:10px" fill="currentColor"><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" /></svg>
                      Ø§Ø¨Ø¯Ø£ Ø§Ù„ÙØ­Øµ
                    </button>
                  </div>
                </div>

              </form>
            </div>
          </div>
        </div>

        <!-- Compact scan panel shown under the search card for immediate feedback -->
        <div id="scan-panel-top" class="right-panel hidden" aria-hidden="true"
          style="margin:0 0 20px 0">
          <h3 class="muted">Ø­Ø§Ù„Ø© Ø§Ù„ÙØ­Øµ</h3>
          <div style="margin-top:6px" class="status" id="scan-progress-top"
            aria-live="polite"></div>
        </div>

        <div>
          <div class="features-box">
            <div class="features-grid">
              <div class="feature-card">
                <div class="icon" style="color:var(--accent-color);">
                  <!-- Globe outline -->
                  <svg viewBox="0 0 24 24" aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"><path
                      d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"
                      stroke-linecap="round"
                      stroke-linejoin="round"></path><path d="M2.05 12h19.9"
                      stroke-linecap="round"
                      stroke-linejoin="round"></path><path d="M12 2.05v19.9"
                      stroke-linecap="round"
                      stroke-linejoin="round"></path></svg>
                </div>
                <strong>ØªÙˆØµÙŠØ§Øª Ø¹Ù…Ù„ÙŠØ©</strong>
                <div class="muted">ØªÙˆØµÙŠØ§Øª Ù…Ø­Ø¯Ø¯Ø© ÙˆÙ‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ†ÙÙŠØ° Ù„ÙƒÙ„ Ù…Ø¹ÙŠØ§Ø±</div>
              </div>
              <div class="feature-card">
                <div class="icon" style="color:var(--secondary-color);">
                  <!-- Shield outline -->
                  <svg viewBox="0 0 24 24" aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"><path
                      d="M12 2l7 3v5c0 5-3.58 9.74-7 12-3.42-2.26-7-7-7-12V5l7-3z"
                      stroke-linecap="round"
                      stroke-linejoin="round"></path></svg>
                </div>
                <strong>ØªØ­Ù„ÙŠÙ„ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</strong>
                <div class="muted">ØªØ­Ù„ÙŠÙ„ Ù…ØªÙ‚Ø¯Ù… Ù„Ø§ÙƒØªØ´Ø§Ù Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø§Ù†Ø­Ø±Ø§Ù
                  ÙˆØ§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</div>
              </div>
              <div class="feature-card">
                <div class="icon" style="color:var(--primary-color);">
                  <!-- Check circle outline -->
                  <svg viewBox="0 0 24 24" aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12"
                      r="9" stroke-linecap="round"
                      stroke-linejoin="round"></circle><path d="M9 12l2 2 4-4"
                      stroke-linecap="round"
                      stroke-linejoin="round"></path></svg>
                </div>
                <strong>56 Ù…Ø¹ÙŠØ§Ø±Ø§Ù‹ Ø´Ø§Ù…Ù„Ø©</strong>
                <div class="muted">ÙØ­Øµ Ø´Ø§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ù…Ø¹Ø§ÙŠÙŠØ± Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµÙ…ÙŠÙ…
                  Ø§Ù„Ù…ÙˆØ­Ø¯</div>
              </div>
            </div>
          </div>

          <div id="scan-panel" class="right-panel hidden" aria-hidden="true">
            <h3 class="muted">Ø­Ø§Ù„Ø© Ø§Ù„ÙØ­Øµ</h3>
            <div class="step active"><div class="dot"></div><div><strong>1.
                  Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·</strong><div class="muted">Ø³Ù†Ø±Ø³Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù„Ù‰
                  Ø§Ù„Ø®Ø§Ø¯Ù… Ù„ØªÙ†ÙÙŠØ° Ø§Ù„ÙØ­Øµ</div></div></div>
            <div class="step" id="step-2"><div class="dot"></div><div><strong>2.
                  ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©</strong><div class="muted">Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø£Ù„ÙˆØ§Ù†ØŒ Ø®Ø·ÙˆØ·
                  ÙˆÙ‚ÙŠÙ… Ø§Ù„Ù…Ø³Ø§ÙØ§Øª</div></div></div>
            <div class="step" id="step-3"><div class="dot"></div><div><strong>3.
                  Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</strong><div class="muted">Ø­ÙØ¸ ØªÙ‚Ø±ÙŠØ± HTML Ùˆ JSON
                  ÙÙŠ Ù…Ø¬Ù„Ø¯ reports</div></div></div>
            <div style="margin-top:12px" class="status" id="scan-progress"
              aria-live="polite"></div>
          </div>
        </div>

      </div>
    </div>

    <script>
    const form = document.getElementById('scan-form');
    const progress = document.getElementById('scan-progress');
    const progressTop = document.getElementById('scan-progress-top');
    const step2 = document.getElementById('step-2');
    const step3 = document.getElementById('step-3');

    // Detect when the page is opened locally (file://) or without a hostname and
    // default the backend to the known local server so the health check works.
    const DEFAULT_BACKEND = 'http://localhost:3001';
    let backendUrl;
    if (window.location.protocol === 'file:' || !window.location.hostname) {
      backendUrl = DEFAULT_BACKEND;
    } else if (window.location.hostname === '127.0.0.1' || window.location.hostname === 'localhost') {
      backendUrl = DEFAULT_BACKEND;
    } else {
      backendUrl = `${window.location.protocol}//${window.location.hostname}${window.location.port ? ':' + window.location.port : ''}`;
    }

    function setStatus(text, busy=false){
      // Update both progress targets if available so users see feedback immediately
      const targets = [progressTop, progress].filter(Boolean);
      targets.forEach(t => { t.textContent = ''; if(busy){ const loader = document.createElement('span'); loader.className='loader'; t.appendChild(loader); } const span = document.createElement('span'); span.textContent = text; span.style.marginInlineStart='8px'; t.appendChild(span); });
    }

    // Helper: show the "open report" button and set its link to the backend reports path
    // The button will be placed inside the compact scan panel (`#scan-panel-top`) and centered.
    function showReportButton() {
      let btn = document.getElementById('open-report');
      const panelTop = document.getElementById('scan-panel-top');
      // If the button does not exist, create it
      if (!btn) {
        btn = document.createElement('button');
        btn.id = 'open-report';
        btn.className = 'ghost';
        btn.type = 'button';
        btn.textContent = 'Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±';
        btn.setAttribute('aria-hidden', 'false');
        btn.onclick = () => window.open(`${backendUrl}/reports/report.html`, '_blank');
      }

      // Ensure the compact scan panel is visible
      if (panelTop) {
        panelTop.classList.remove('hidden');
        panelTop.setAttribute('aria-hidden', 'false');
        // create or reuse an actions container inside panelTop
        let actions = panelTop.querySelector('.scan-actions');
        if (!actions) {
          actions = document.createElement('div');
          actions.className = 'scan-actions';
          panelTop.appendChild(actions);
        }
        // Avoid duplicating the button inside the container
        if (!actions.contains(btn)) {
          actions.appendChild(btn);
        }
        btn.classList.remove('hidden');
        try{ btn.focus(); }catch(e){}
      } else {
        // Fallback: place near the search card
        const searchCard = document.querySelector('.search-card');
        if (searchCard && searchCard.parentNode && !document.getElementById('open-report')) {
          searchCard.parentNode.insertBefore(btn, searchCard.nextSibling);
        }
      }
    }

    // Check if a report is available on the backend; show the button if so.
    // Some environments (file:// or strict CORS) may block HEAD requests; fall
    // back to a health check so users opening the page locally still see the
    // report button when the backend is reachable.
    async function checkReportAvailable() {
      try {
        // Try a lightweight HEAD first (fast)
        const r = await fetch(`${backendUrl}/reports/report.html`, { method: 'HEAD' });
        if (r && r.ok) {
          showReportButton();
          return;
        }
      } catch (e) {
        // proceed to health fallback
      }

      // Fallback: if the backend is alive, show the button (report may exist)
      try {
        const h = await fetch(`${backendUrl}/health`, { method: 'GET' });
        if (h && h.ok) {
          showReportButton();
        }
      } catch (e) {
        // Still ignore â€” leave button hidden
      }
    }

    // Email validation and form field visibility control
    const emailInput = document.getElementById('user-email');
    const urlSection = document.getElementById('url-section');
    const submitSection = document.getElementById('submit-section');
    
    // Banned email providers (personal emails)
    const bannedDomains = ['gmail.com', 'outlook.com', 'yahoo.com', 'icloud.com', 'hotmail.com', 'live.com', 'msn.com', 'ymail.com', 'aol.com'];
    
    function validateEmail(email) {
      // Check basic email format
      if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        return { valid: false, message: 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­' };
      }
      
      // Extract domain
      const domain = email.split('@')[1].toLowerCase();
      
      // Check if domain is banned
      if (bannedDomains.includes(domain)) {
        return { valid: false, message: 'ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø±Ø³Ù…ÙŠ (ØºÙŠØ± gmail, outlook, yahoo, icloud, hotmail)' };
      }
      
      return { valid: true, message: '' };
    }
    
    if (emailInput && urlSection && submitSection) {
      emailInput.addEventListener('input', () => {
        const email = emailInput.value.trim();
        const validation = validateEmail(email);
        
        // Remove any existing error message
        const existingError = emailInput.parentElement.querySelector('.email-error');
        if (existingError) existingError.remove();
        
        if (validation.valid) {
          emailInput.style.borderColor = '#16a34a';
          emailInput.style.background = 'white';
          urlSection.style.display = 'block';
          submitSection.style.display = 'flex';
        } else {
          emailInput.style.borderColor = '#dc2626';
          emailInput.style.background = '#fef2f2';
          urlSection.style.display = 'none';
          submitSection.style.display = 'none';
          
          // Show error message if email has @ (user is trying to enter email)
          if (email.includes('@') && validation.message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'email-error';
            errorDiv.style.cssText = 'color:#dc2626;font-size:11px;margin-top:6px;display:flex;align-items:center;gap:4px';
            errorDiv.innerHTML = `<svg viewBox="0 0 24 24" style="width:12px;height:12px;flex-shrink:0" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>${validation.message}`;
            emailInput.parentElement.appendChild(errorDiv);
          }
        }
      });
      
      // Also validate on blur
      emailInput.addEventListener('blur', () => {
        const email = emailInput.value.trim();
        if (email) {
          const validation = validateEmail(email);
          if (!validation.valid) {
            const existingError = emailInput.parentElement.querySelector('.email-error');
            if (!existingError && validation.message) {
              const errorDiv = document.createElement('div');
              errorDiv.className = 'email-error';
              errorDiv.style.cssText = 'color:#dc2626;font-size:11px;margin-top:6px;display:flex;align-items:center;gap:4px';
              errorDiv.innerHTML = `<svg viewBox="0 0 24 24" style="width:12px;height:12px;flex-shrink:0" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>${validation.message}`;
              emailInput.parentElement.appendChild(errorDiv);
            }
          }
        }
      });
    } else {
      console.error('Email form elements not found:', { emailInput, urlSection, submitSection });
    }

    // Do NOT auto-show the report button on load â€” only show after a successful scan
    // (checkReportAvailable intentionally not called here)

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const email = document.getElementById('user-email').value.trim();
      if (!email) {
        setStatus('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', false);
        return;
      }
      
      // Validate email again before submission
      const validation = validateEmail(email);
      if (!validation.valid) {
        setStatus(validation.message, false);
        return;
      }
      
      let raw = document.getElementById('website-url').value.trim();
      if (!raw) {
        setStatus('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹', false);
        return;
      }
      // Normalize: if user enters domain only, add https://
      let url = raw;
      if (!/^https?:\/\//i.test(url)) {
        // Basic domain validation (very light): contains at least one dot and no spaces
        if (!/^[\w.-]+\.[a-z]{2,}$/i.test(url)) {
          setStatus('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¯ÙˆÙ…ÙŠÙ† ØµØ§Ù„Ø­ Ù…Ø«Ù„ example.gov.sa', false);
          return;
        }
        url = 'https://' + url;
      }
      // Show normalized URL to the user
      setStatus('Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ: ' + url, true);
      step2.classList.add('active');
      // Reveal the scan status panels (compact top and full right) and bring the top one into view
      try {
        // Only show the compact scan status under the search bar to avoid duplicate
        // "Ø­Ø§Ù„Ø© Ø§Ù„ÙØ­Øµ" panels. Keep the right-hand detailed panel hidden.
        const panel = document.getElementById('scan-panel');
        const panelTop = document.getElementById('scan-panel-top');
        if (panel) {
          panel.classList.add('hidden');
          panel.setAttribute('aria-hidden', 'true');
        }
        if (panelTop) {
          panelTop.classList.remove('hidden');
          panelTop.setAttribute('aria-hidden', 'false');
          panelTop.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      } catch (e) { /* ignore scrolling errors */ }
      try{
        // quick health check to fail fast with clearer messaging
        const health = await fetch(`${backendUrl}/health`, { method: 'GET' });
        if (!health.ok) {
          setStatus('Ø§Ù„Ø®Ø§Ø¯Ù… ØºÙŠØ± Ù…ØªØ§Ø­ (health check failed)');
          return;
        }

  const fastMode = !!document.getElementById('fast-mode').checked;
  const res = await fetch(`${backendUrl}/scan`, {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({url, fastMode, email})});
        if(res.ok){
          setStatus('ØªÙ… Ø§Ù„ÙØ­Øµ Ø¨Ù†Ø¬Ø§Ø­');
          step3.classList.add('active');
          showReportButton();
        } else {
          const data = await res.json().catch(()=>({error:'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…'}));
          setStatus('ÙØ´Ù„ Ø§Ù„ÙØ­Øµ: ' + (data.error || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'));
        }
      }catch(err){
        // Provide more helpful guidance for common errors (CORS, network, mixed-content)
        console.error('Scan request failed:', err);
        if (err instanceof TypeError) {
          setStatus('ÙØ´Ù„ Ø§Ù„ÙØ­Øµ: ØºÙŠØ± Ù‚Ø§Ø¯Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø®Ø§Ø¯Ù… ÙŠØ¹Ù…Ù„ ÙˆØ£Ù† Ø§Ù„ØµÙØ­Ø© ØªØ³ØªØ®Ø¯Ù… Ù†ÙØ³ Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ (http/https).');
        } else {
          setStatus('ÙØ´Ù„ Ø§Ù„ÙØ­Øµ: ' + err.message);
        }
      }
    });
  </script>
  </body>